# 02. 開発環境のセットアップ

Tauri 開発に必要なツールをインストールし、開発環境を整えます。WPF では Visual Studio と.NET SDK があれば十分でしたが、Tauri では複数のツールが必要です。

## 必要なツール一覧

| ツール          | 目的                               | WPF での相当              |
| --------------- | ---------------------------------- | ------------------------- |
| Node.js         | フロントエンド開発・パッケージ管理 | NuGet Package Manager     |
| Rust            | バックエンド開発・コンパイル       | .NET SDK                  |
| VS Code         | 統合開発環境                       | Visual Studio             |
| Xcode CLI Tools | macOS でのネイティブビルド         | Visual Studio Build Tools |

## インストール手順（macOS）

### 1. Node.js のインストール

Node.js は JavaScript/TypeScript の実行環境で、NPM（パッケージマネージャー）も含まれています。

```bash
# 公式サイトからインストール、または Homebrew を使用
brew install node

# インストール確認
node -v    # v18.0.0 以上
npm -v     # v8.0.0 以上
```

### 2. Rust のインストール

Rust は Tauri のバックエンドで使用するプログラミング言語です。

```bash
# Rust 公式インストーラー
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# 環境変数を読み込み
source $HOME/.cargo/env

# インストール確認
rustc --version   # rustc 1.70.0 以上
cargo --version   # cargo 1.70.0 以上
```

### 3. Xcode Command Line Tools（macOS のみ）

ネイティブコンパイルに必要です。

```bash
xcode-select --install

# インストール確認
xcode-select -p
# /Library/Developer/CommandLineTools または /Applications/Xcode.app/Contents/Developer
```

### 4. VS Code のインストールと拡張機能

[Visual Studio Code](https://code.visualstudio.com/) をダウンロードしてインストールします。

必須の拡張機能：

-   **Tauri**: Tauri プロジェクトのサポート
-   **rust-analyzer**: Rust 言語サポート
-   **TypeScript and JavaScript Language Features**: TypeScript サポート（通常は標準搭載）

推奨の拡張機能：

-   **HTML CSS Support**: HTML/CSS の補完
-   **Prettier**: コードフォーマッター
-   **GitLens**: Git 機能強化

VS Code で拡張機能をインストール：

1. VS Code を開く
2. 左のサイドバーの Extensions アイコンをクリック
3. 上記の拡張機能名で検索してインストール

## インストール確認

以下のコマンドで全ての必要なツールがインストールされているか確認します：

```bash
# Node.js/npm
node -v && npm -v

# Rust/Cargo
rustc --version && cargo --version

# Xcode CLI Tools
xcode-select -p

# 全て表示されれば準備完了
```

期待される出力例：

```
v20.9.0
10.1.0
rustc 1.72.0 (5680fa18f 2023-08-23)
cargo 1.72.0 (103a7ff2e 2023-08-15)
/Applications/Xcode.app/Contents/Developer
```

## VS Code の設定

WPF 開発と同様の快適な開発体験のために、VS Code を設定します。

### settings.json の推奨設定

VS Code で `Cmd+,` を押し、右上の「Open Settings (JSON)」をクリックして以下を追加：

```json
{
    "editor.formatOnSave": true,
    "editor.codeActionsOnSave": {
        "source.fixAll": true
    },
    "rust-analyzer.checkOnSave.command": "clippy",
    "typescript.preferences.quoteStyle": "single",
    "html.format.indentInnerHtml": true
}
```

## プロジェクトテンプレートの準備

Tauri の公式テンプレートを使って新しいプロジェクトを作成できるようにします：

```bash
# npm のキャッシュをクリア（念のため）
npm cache clean --force

# create-tauri-app のインストール確認
npm create tauri-app@latest --help
```

## 開発環境の動作確認

簡単なテストプロジェクトを作成して環境を確認します：

```bash
# テスト用ディレクトリ作成
mkdir ~/tauri-test
cd ~/tauri-test

# Tauri プロジェクト作成（vanilla TypeScript テンプレート）
npm create tauri-app@latest . -- -y -m npm -t vanilla-ts --tauri-version 2

# 依存関係インストール
npm install

# 開発サーバー起動（初回は時間がかかります）
npm run tauri dev
```

成功すれば、小さなウィンドウが開いて「Welcome to Tauri!」という画面が表示されます。

ウィンドウを閉じてテストプロジェクトを削除：

```bash
cd ~
rm -rf ~/tauri-test
```

## トラブルシューティング

### よくある問題と解決方法

**1. `rustc: command not found`**

```bash
# Rust 環境変数の再読み込み
source $HOME/.cargo/env

# それでも解決しない場合は再起動後に再試行
```

**2. `xcode-select: error: tool 'xcodebuild' requires Xcode`**

```bash
# Xcode Command Line Tools の再インストール
sudo xcode-select --install
```

**3. `npm ERR! network request to https://registry.npmjs.org/...`**

```bash
# ネットワーク設定の確認、または別のネットワークで試行
npm config set registry https://registry.npmjs.org/
```

**4. 初回ビルドが非常に遅い**
これは正常です。Rust の依存関係をダウンロード・コンパイルするため初回は 10-20 分かかることがあります。2 回目以降は高速になります。

## 次のステップ

開発環境が整ったら、[03\_最初の Tauri アプリを作る.md](./03_最初のTauriアプリを作る.md) で実際にアプリケーションを作成してみましょう。
